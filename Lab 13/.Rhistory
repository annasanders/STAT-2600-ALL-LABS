library(gapminder)
library(tidyverse)
col_summary <- function (df, fun)
{
out <- vector("double", lenght(df))
for(i in seq_along(df)){
out[i] <- fun(df[[i]])
}
return(out)
}
knitr::opts_chunk$set(echo = TRUE)
gapminder <- gapminder
gdpgrowth <- read.csv2(gdp_growth)
gdpgrowth <- read.csv2("gdp_growth.csv"")
gdpgrowth <- read.csv2("gdp_growth.csv")
gdpgrowth <- read.csv2("gdp_growth.csv")
gdpgrowth <- read.csv2("gdp_growth.csv")
gdpgrowth <- read.csv2(gdp_growth.csv)
gdpgrowth <- read.csv2(file= "gdp_growth.csv", header= TRUE)
gdpgrowth <- read.csv(file= "gdp_growth.csv", header= TRUE)
gdpgrowth <- read.csv(file= "Lab 13/gdp_growth.csv", header= TRUE)
gdpgrowth <- read_excel(file= "gdp_growth.csv", header= TRUE)
gdpgrowth <- read_excel(file= "gdp_growth", header= TRUE)
library(readxl)
gdp_growth <- read_excel("gdp_growth.xlsx")
View(gdp_growth)
gdp_growth <- read_excel("gdp_growth.xlsx", heading= TRUE)
gdp_growth <- read_excel("gdp_growth.xlsx", header= TRUE)
gdp_growth <- read_xlsx("gdp_growth.xlsx", header= TRUE)
gdp_growth <- read_xlsx("gdp_growth.xlsx")
View(gdp_growth)
Indicator_HDI <- read_excel("Indicator_HDI.xlsx")
View(Indicator_HDI)
knitr::opts_chunk$set(echo = TRUE)
Indicator_HDI2 <- Indicator_HDI%>%
complete.cases()
Indicator_HDI2 <-
Indicator_HDI[complete.cases(Indicator_HDI), ]
View(Indicator_HDI2)
Indicator_HDI2 <- Indicator_HDI%>%
na.omit()
Indicator_HDI3 <- Indicator_HDI2%>%
gather(`1980`,`1990`,`2000`,`2005`,`2006`,`2997`,`2008`,`2009`,`2011`, key="year", values="HDI")
Indicator_HDI3 <- Indicator_HDI2%>%
gather(`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`, key="year", values="HDI")
View(Indicator_HDI3)
Indicator_HDI3 <- Indicator_HDI2%>%
gather(Indicator_HDI2,`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`, key="year", values="HDI")
View(Indicator_HDI3)
gather(Indicator_HDI2,`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`, key="year", values="HDI")
Indicator_HDI3 <- Indicator_HDI2%>%
gather(Indicator_HDI2,`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`, key="year", values="HDI")
Indicator_HDI3 <- Indicator_HDI2%>%
gather(Indicator_HDI2,1980,1990,2000,2005,2006,2007,2008,2009,2011, key="year", values="HDI")
Indicator_HDI3 <- Indicator_HDI2%>%
gather(Indicator_HDI2,`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`, key="year", values="HDI")
Indicator_HDI3 <- Indicator_HDI2%>%
gather(Indicator_HDI2, key="year", values="HDI",
"19980","1990","2000","2005","2006","2007","2008","2009","2011")
Indicator_HDI3 <- Indicator_HDI2%>%
gather(Indicator_HDI2, key="year", values="HDI",
"1980","1990","2000","2005","2006","2007","2008","2009","2011")
View(Indicator_HDI3)
Indicator_HDI3 <- Indicator_HDI2%>%
gather(Indicator_HDI2, key="year", values="cases",
"1980","1990","2000","2005","2006","2007","2008","2009","2011")
Indicator_HDI3 <- Indicator_HDI2%>%
gather(key="year", values="cases",
"1980","1990","2000","2005","2006","2007","2008","2009","2011")
Indicator_HDI3 <- Indicator_HDI2%>%
gather(key="year", values="years",
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
Indicator_HDI3 <- Indicator_HDI2%>%
gather(key="year", values="year",
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
Indicator_HDI3 <- Indicator_HDI2%>%
gather(key=`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`, values="HDI",
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
Indicator_HDI3 <- Indicator_HDI2%>%
gather(key=`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`, values="HDI")
Indicator_HDI3 <- Indicator_HDI2%>%
gather(key="year", values="HDI",
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
gather(Indicator_HDI2, key="year", values="HDI",
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
gather(Indicator_HDI2, key="year", values=
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
Indicator_HDI3 <- gather(Indicator_HDI2, key="year", values=
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
Indicator_HDI3 <- setnames(Indicator_HDI3, old=c("HDI","year", "1990"), new=c("country","year" "HDI"))
Indicator_HDI3 <- setnames(Indicator_HDI3, old=c("HDI","year", "1990"), new=c("country","year", "HDI"))
Indicator_HDI3 <- setnames(Indicator_HDI3, old=c("HDI","year", "1990"), new=c("country","year","HDI"))
names(Indicator_HDI3) <- c("country", "year", "HDI")
gapminder2 <- left_join(Indicator_HDI3, gapminder)
View(gapminder)
View(Indicator_HDI3)
transform(Indicator_HDI3, year=as.numeric())
transform(Indicator_HDI3, year=as.numeric(year))
Indicator_HDI3 <- transform(Indicator_HDI3, year=as.numeric(year))
View(Indicator_HDI3)
gapminder2 <- left_join(Indicator_HDI3, gapminder)
gapminder2 <- left_join(Indicator_HDI3, gapminder, by= c("country", "year"))
View(gapminder2)
View(gapminder)
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
Indicator_HDI3 <- transform(Indicator_HDI3, country=as.factor(country))
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminder2 <- right_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminter3 <- gapminder2%>%
na.omit
gapminter3 <- gapminder2%>%
na.omit()
View(gapminter3)
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminder <- transform(gapminder, country=as.character(country))
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
Indicator_HDI3 <- transform(Indicator_HDI3, country=as.factor(country))
gapminder <- gapminder
gapminder <- gapminder
library(gapminder)
gapminder <- gapminder
Indicator_HDI2 <- Indicator_HDI%>%
na.omit()
Indicator_HDI3 <- gather(Indicator_HDI2, key="year", values=
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
Indicator_HDI3 <- transform(Indicator_HDI3, year=as.numeric(year))
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
names(Indicator_HDI3) <- c("country", "year", "HDI")
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminter3 <- gapminder2%>%
na.omit()
gapminder3 <- gapminder2%>%
filter(continent= "Asia"|"America")
gapminder3 <- gapminder2%>%
filter(continent== "Asia"|"America")
gapminder3 <- gapminder2%>%
filter(continent== "Asia", continent== "America")
gapminter3 <- gapminder2%>%
na.omit()
gapminder4 <- gapminder3%>%
filter(continent== "Asia", continent== "America")
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminter3 <- gapminder2%>%
na.omit()
gapminder4 <- gapminder3%>%
filter(continent== "Asia"| continent== "America")
gapminter3 <- gapminder2%>%
na.omit()
#This entire dataset only has the year 2007 as it was the only year both gapminder and the hdi were recorded. We will all compare two continent groupings (e.g. Asia and America) to see if there is a significant difference between the histogram and the true data.
gapminter3 <- gapminder2%>%
na.omit()
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminter3 <- gapminder2%>%
na.omit()
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminter3 <- gapminder2%>%
na.omit()
View(gapminder3)
Indicator_HDI <- read_excel("Indicator_HDI.xlsx")
Indicator_HDI2 <- Indicator_HDI%>%
na.omit()
Indicator_HDI3 <- gather(Indicator_HDI2, key="year", values=
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
names(Indicator_HDI3) <- c("country", "year", "HDI")
Indicator_HDI3 <- transform(Indicator_HDI3, year=as.numeric(year))
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminter3 <- gapminder2%>%
na.omit()
Indicator_HDI2 <- Indicator_HDI%>%
na.omit()
View(Indicator_HDI3)
Indicator_HDI3 <- transform(Indicator_HDI3, year=as.numeric(year))
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminter3 <- gapminder2%>%
na.omit()
gapminter3 <- gapminder2%>%
na.omit()
View(gapminder3)
gapminter3 <- gapminder2%
gapminter3 <- gapminder2
knitr::opts_chunk$set(echo = TRUE)
library(gapminder)
library(tidyverse)
#Run this code to get the new data
library(readxl)
Indicator_HDI <- read_excel("Indicator_HDI.xlsx")
Indicator_HDI2 <- Indicator_HDI%>%
na.omit()
Indicator_HDI3 <- gather(Indicator_HDI2, key="year", values=
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
names(Indicator_HDI3) <- c("country", "year", "HDI")
Indicator_HDI3 <- transform(Indicator_HDI3, year=as.numeric(year))
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminter3 <- gapminder2
View(gapminter3)
gapminter3 <- gapminder2%>%
na.omit()
gapminder4 <- gapminder3%>%
filter(continent== "Asia"| continent== "America")
gapminder3 <- gapminder2%>%
na.omit()
gapminder4 <- gapminder3%>%
filter(continent== "Asia"| continent== "America")
knitr::opts_chunk$set(echo = TRUE)
corr_mat %>% map_dbl(sd)
library(tidyverse)
library(gapminder)
gapminder <- gapminder
Indicator_HDI <- read_excel("Indicator_HDI.xlsx")
#Run this code to get the new data
library(readxl)
Indicator_HDI <- read_excel("Indicator_HDI.xlsx")
Indicator_HDI2 <- Indicator_HDI%>%
na.omit()
Indicator_HDI3 <- gather(Indicator_HDI2, key="year", values=
`1980`,`1990`,`2000`,`2005`,`2006`,`2007`,`2008`,`2009`,`2011`)
names(Indicator_HDI3) <- c("country", "year", "HDI")
Indicator_HDI3 <- transform(Indicator_HDI3, year=as.numeric(year))
Indicator_HDI3 <- transform(Indicator_HDI3, year=as.numeric(year))
gapminder2 <- full_join(Indicator_HDI3, gapminder, by= c("country", "year"))
gapminder3 <- gapminder2%>%
na.omit()
hdi <- gapminder3%>%
select(HDI)
life_exp <- gapminder3%>%
select(lifeExp)
life_exp <- life_exp$lifeExp
hdi <- hdi$HDI
real_cor <- cor(hdi,life_exp)
perm_cor <- function(perms = 1000, x, y)
{
corr_mat <- matrix(0,length(perms),1)
mylist <- rep(list(0,1000))
for (i in c(1:perms))
{
mylist[[i]] <- sample(y, length(y), replace = FALSE)
corr_mat[[i]] = real_cor + cor(x,mylist[[i]])
}
return(corr_mat)
sd <- corr_mat %>% map_dbl(sd)
return(sd)
}
perm_cor(hdi, life_exp)
perm_cor(life_exp, hdi)
perm_cor(`life_exp`, `hdi`)
perm_cor(`life_exp`, `hdi`)
perm_cor(x=hdi, y=life_exp)
hdilife<-perm_cor(x=hdi, y=life_exp)
sd <- corr_mat %>% map_dbl(sd)
perm_cor <- function(perms = 1000, x, y)
{
corr_mat <- matrix(0,length(perms),1)
mylist <- rep(list(0,1000))
for (i in c(1:perms))
{
mylist[[i]] <- sample(y, length(y), replace = FALSE)
corr_mat[[i]] = real_cor + cor(x,mylist[[i]])
}
return(corr_mat)
sd <- corr_mat %>% map_dbl(sd)
}
perm_cor <- function(perms = 1000, x, y)
{
corr_mat <- matrix(0,length(perms),1)
mylist <- rep(list(0,1000))
for (i in c(1:perms))
{
mylist[[i]] <- sample(y, length(y), replace = FALSE)
corr_mat[[i]] = real_cor + cor(x,mylist[[i]])
}
return(corr_mat)
sd <- corr_mat %>% map_dbl(sd)
return(sd)
}
hdilife<-perm_cor(x=hdi, y=life_exp)
perm_cor <- function(perms = 1000, x, y)
{
corr_mat <- matrix(0,length(perms),1)
mylist <- rep(list(0,1000))
for (i in c(1:perms))
{
mylist[[i]] <- sample(y, length(y), replace = FALSE)
corr_mat[[i]] = real_cor + cor(x,mylist[[i]])
}
return(corr_mat)
sd <- corr_mat %>% map_dbl(sd)
return(sd)
}
sd <- hdilife %>% map_dbl(sd)
return(sd)
sd <- hdilife %>% map_dbl(sd)
hdlife2<- as.tibble(perm_cor(x=hdi, y=life_exp))
sd <- hdilife2 %>% map_dbl(sd)
hdilife2<- as.tibble(perm_cor(x=hdi, y=life_exp))
(sd)
map_dbl(hdilife2, median)
map_dbl(hdilife2, sd)
map_dbl(hdilife2, median)
standard_dev <- sd(perm_cor(x=hdi, y=life_exp))
map_dbl(hdilife2, median)
correlation <- as.tibble(hdilife)
props <- as.tibble(quantile(hidlife))
props <- as.tibble(quantile(hdilife))
standard_dev <- sd(hdilife)
summary(correlation)
map_dbl(hdilife2, median)
hdilife2 <- as.tibble(quantile(hdilife))
ggplot(hdilife2, aes(x=value))+geom_histogram() + labs(x= "correlation", y = "count", title = "correlation between GDP per capita and life expectency")+ geom_vline(xintercept = real_cor, col = "Blue")
hdilife<-perm_cor(x=hdi, y=life_exp)
(hdilife2, median)
hidlife2 <- as.tibble(hdilife)
map_dbl(hdilife2, median)
props <- as.tibble(quantile(hdilife))
standard_dev <- sd(hdilife)
+geom_vline(xintercept = real_cor, col = "Blue")
+geom_vline(xintercept = real_cor, col = "Blue")
ggplot(hdilife2, aes(x=value))+
geom_histogram()+
labs(x= "correlation", y = "count", title = "Correlation Between HDI and life expectency")+
geom_vline(xintercept = real_cor, col = "Blue")
hdilife2 <- as.tibble(hdilife)
ggplot(hdilife2, aes(x=value))+
geom_histogram()+
labs(x= "correlation", y = "count", title = "Correlation Between HDI and life expectency")+
geom_vline(xintercept = real_cor, col = "Blue")
knitr::opts_chunk$set(echo = TRUE)
real_cor <- cor(hdi,life_exp)
?cor
pop <- gapminder3%>%
select(pop)
pop <- pop$pop
real_cor <- cor(hdi,pop)
real_corpop <- cor(hdi,pop)
real_corlife <- cor(hdi,life_exp)
hdipop<-perm_cor(x=hdi, y=pop)
hdipop2 <- as.tibble(hdipop)
map_dbl(hdipop2, median)
props <- as.tibble(quantile(hdipop))
standard_dev <- sd(hdipop)
ggplot(hdipop2, aes(x=value))+
geom_histogram()+
labs(x= "correlation", y = "count", title = "Correlation Between HDI and life expectency")+
geom_vline(xintercept = real_cor, col = "Blue")
ggplot(hdilife2, aes(x=value))+
geom_histogram()+
labs(x= "correlation", y = "count", title = "Correlation Between HDI and life expectency")+
geom_vline(xintercept = real_corlife, col = "Blue")
ggplot(hdipop2, aes(x=value))+
geom_histogram()+
labs(x= "correlation", y = "count", title = "Correlation Between HDI and Population")+
geom_vline(xintercept = real_corpop, col = "Blue")
ggplot(hdipop2, aes(x=value))+
geom_histogram()+
labs(x= "correlation", y = "count", title = "Correlation Between HDI and Population")+
geom_vline(xintercept = real_corpop, col = "Blue")
ggplot(hdilife2, aes(x=value))+
geom_histogram()+
labs(x= "correlation", y = "count", title = "Correlation Between HDI and life expectency")+
geom_vline(xintercept = real_cor, col = "Blue")
ggplot(hdilife2, aes(x=value))+
geom_histogram()+
labs(x= "correlation", y = "count", title = "Correlation Between HDI and life expectency")+
geom_vline(xintercept = real_corlife, col = "Blue")
summary(hdipop2)
summary(hdilife2)
