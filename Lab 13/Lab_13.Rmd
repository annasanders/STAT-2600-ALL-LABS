---
title: "Lab 13"
author: "Data Me Pls: Amanda, James, Chris, Anna"
date: "April 12, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Amanda

## James

## Chris
```{r, Eval=FALSE}
hdi <- gapminder3%>%
  select(HDI)

life_exp <- gapminder3%>%
  select(lifeExp)

life_exp <- life_exp$lifeExp
hdi <- hdi$HDI

real_cor <- cor(hdi,life_exp)

perm_cor <- function(perms = 1000, x, y)
{
  corr_mat <- matrix(0,length(perms),1)
  mylist <- rep(list(0,1000))
  
  for (i in c(1:perms))
  {
    mylist[[i]] <- sample(y, length(y), replace = FALSE)
    corr_mat[[i]] = real_cor + cor(x,mylist[[i]])
  }
  return(corr_mat)
  
}

hdigdp <- as.tibble(perm_cor(x=hdi, y=gdp))

map_dbl(hdigdp, median)


props <- as.tibble(quantile(hdigdp$value))

standard_dev <- sd(hdigdp$value)

summary(hdigdp)

ggplot(hdigdp, aes(x=value))+geom_histogram() + labs(x= "correlation", y = "count", title = "correlation between GDP per capita and HDI")+ geom_vline(xintercept = real_cor, col = "Blue")
```

## Anna

__Question:__ Is there a correlation between HDI and Life Expectancy?

This question is important becausehigher life expectancy is though to be indiciative of more development in a country. In this way, we need to prove that there is a positive correlation between HDIand Life Expectancy. I chose to use a two sample correlation test to prove that there is a positive correlation.

```{r, Eval=FALSE}
hdi <- gapminder3%>%
  select(HDI)

life_exp <- gapminder3%>%
  select(lifeExp)

life_exp <- life_exp$lifeExp
hdi <- hdi$HDI

real_cor <- cor(hdi,life_exp)

perm_cor <- function(perms = 1000, x, y)
{
  corr_mat <- matrix(0,length(perms),1)
  mylist <- rep(list(0,1000))
  
  for (i in c(1:perms))
  {
    mylist[[i]] <- sample(y, length(y), replace = FALSE)
    corr_mat[[i]] = real_cor + cor(x,mylist[[i]])
  }
  return(corr_mat)
  
}

hdilife<-perm_cor(x=hdi, y=life_exp)

map_dbl(hdilife2, median)

hdilife2 <- as.tibble(hdilife)

props <- as.tibble(quantile(hdilife))

standard_dev <- sd(hdilife)

summary(hdilife2)

ggplot(hdilife2, aes(x=value))+
  geom_histogram()+
  labs(x= "correlation", y = "count", title = "Correlation Between HDI and life expectency")+
  geom_vline(xintercept = real_cor, col = "Blue")
```