---
title: "Lab 12"
author: "Data Me Pls: James, Amanda, Chris, Anna"
date: "April 5, 2019"
output: html_document
---

#Two-Sample Permutation Test

__Question:__ 
```{r, eval=FASLE}
library(tidyverse)
library(gapminder)

gapminder <- gapminder

perm_mean <- function(perms = 1000, values, n1)
{
  ## Variables ##
  # perms: The number of permutations 
  # values (num): 
  # n1 (int): Size of group 1
  ###############
  
  # Step 1:
  # Create vector of zeroes of length "perms" to store
  # permuted mean differnces
  mean_vect <- meanVector(0,1000,1)
  
  # Loop throught number of permutations
  for (i in c(1:perms))
  {
    # Step 2:
    # Randomly separate vector "values" into disjoint 
    # groups of size "n1" and "length(values) - n1" respectively
    
    
    # Step 3:
    # Compute the sample means for the two groups from 
    # step 2
    
    # Step 4: 
    # Compute the difference in sample means, store the
    # value in the vector from step 1
    
  }
  
  # Step 5:
  # Return new updated vector, created in step 1
  
}
```

question this answers is: is there a correlation between the GDP per Capita and life expectency. 
```{r, eval=FASLE}


```{r setup, include=FALSE}



library(tidyverse)
library(gapminder)

gapminder <- gapminder

gdp_percap <- gapminder%>%
  select(gdpPercap)

life_exp <- gapminder %>%
  select(lifeExp)

life_exp <- life_exp$lifeExp
gdp_percap <- gdp_percap$gdpPercap

perm_cor <- function(perms = 1000, x, y)
{
  ## Variables ##
  # perms: The number of permutations 
  # x: Vector 1 - for computing correlation
  # y: Vector 2 - for computing correlation
  ###############
  
  corr_mat <- matrix(0,1000,1)
  # Step 1:
  # Create vector of zeroes of length "perms" to store
  # permuted mean differnces
  
  # Loop throught number of permutations
  for (i in c(1:perms))
  {
    rsamp <- sample(y, length(y), replace = FALSE)
    
    # Step 2:
    # Randomly mix up the values in the vector "y"
    
    corr_mat[[i]] = cor(x,rsamp)
    # Step 3:
    # Compute the correlation between x and the randomly mixed
    # up y-vector. Store this value in the vector from step 1.
    
  }
  
  # Step 4:
  # Return new updated vector, created in step 1
  return(corr_mat)
}

correlation <- as.tibble(perm_cor(x=gdp_percap,y=life_exp))

ggplot(correlation, aes(x=V1))+geom_histogram()
```
```
The plot shows a normal distribution of data when tested over 100 random samples. The mean of the sample data is centered around zero which would imply that the two factors are uncorrelated. This being said, some generated samples show a weak positive and a weak negative linear correlation. 

# When will it end
