---
title: "Lab 12"
author: "Data Me Pls: James, Amanda, Chris, Anna"
date: "April 5, 2019"
output: html_document
---

```{r, eval=FASLE}


```{r setup, include=FALSE}



library(tidyverse)
library(gapminder)

gapminder <- gapminder

gdp_percap <- gapminder%>%
  select(gdpPercap)

life_exp <- gapminder %>%
  select(lifeExp)

life_exp <- life_exp$lifeExp
gdp_percap <- gdp_percap$gdpPercap

perm_cor <- function(perms = 1000, x, y)
{
  ## Variables ##
  # perms: The number of permutations 
  # x: Vector 1 - for computing correlation
  # y: Vector 2 - for computing correlation
  ###############
  
  corr_mat <- matrix(0,1000,1)
  # Step 1:
  # Create vector of zeroes of length "perms" to store
  # permuted mean differnces
  
  # Loop throught number of permutations
  for (i in c(1:perms))
  {
    rsamp <- sample(y, length(y), replace = FALSE)
    
    # Step 2:
    # Randomly mix up the values in the vector "y"
    
    corr_mat[[i]] = cor(x,rsamp)
    # Step 3:
    # Compute the correlation between x and the randomly mixed
    # up y-vector. Store this value in the vector from step 1.
    
  }
  
  # Step 4:
  # Return new updated vector, created in step 1
  return(corr_mat)
}

correlation <- as.tibble(perm_cor(x=gdp_percap,y=life_exp))

ggplot(correlation, aes(x=V1))+geom_histogram()
```
```

# When will it end
