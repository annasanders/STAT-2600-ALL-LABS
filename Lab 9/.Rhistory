library(tidyverse)
library(lubridate)
# Primary Sorting
bikes <- read_csv("Nice_ride_trip_history_2017_season.csv", col_names = TRUE, col_types= cols(`Start date`= col_datetime(format="%m/%d/%Y %H:%M"), `End date`= col_datetime(format="%m/%d/%Y %H:%M")))
# Loading the Data normally
bikes1 <- read_csv("Nice_ride_trip_history_2017_season.csv")
# Separating by month/year
bikedate <-bikes1%>%
separate(`Start date`, into= c("Sdate", "Stime"), sep= " ")%>%
separate(`End date`, into= c("Edate", "Etime"), sep= " ")
bikedate1 <-bikedate%>%
separate(Sdate, into= c("Smon", "Sday", "Syear"), sep= "/")%>%
separate(Edate, into= c("Emon", "Eday", "Eyear"), sep= "/")
# Putting it back into date form
bikedate2 <-bikedate1%>%
mutate(Sdate= make_date(Syear, Smon, Sday))%>%
mutate(Edate= make_date(Eyear, Emon, Eday))%>%
select(Sdate, Edate, `Start station`, `End station`, `Total duration (Seconds)`)
# Summing Data
daytotal <- bikedate2%>%
group_by(Sdate)%>%
count(Total= n())%>%
select(Sdate, Total)
# July Data
julytotal <- bikedate2%>%
filter(Sdate>= as.Date("2017-07-01") & Sdate<= as.Date("2017-07-31"))
julyloc <- julytotal%>%
group_by(`End station`)%>%
count(Total= n())%>%
select(`End station`, Total)
# July Data
julytotal <- bikedate2%>%
filter(Sdate>= as.Date("2017-07-01") & Sdate<= as.Date("2017-07-31"))
# ggplot
ggplot(daytotal)+
geom_line(mapping= aes(x= Sdate, y= Total))+
labs(x= "Date", y= "Total Rides", title= "Total Rides per day in 2017")+
scale_x_date(breaks=c(as.Date("2017-04-01", origin= "1970-01-01"),
as.Date("2017-05-01", origin= "1970-01-01"),
as.Date("2017-06-01", origin= "1970-01-01"),
as.Date("2017-07-01", origin= "1970-01-01"),
as.Date("2017-08-01", origin= "1970-01-01"),
as.Date("2017-09-01", origin= "1970-01-01"),
as.Date("2017-10-01", origin= "1970-01-01"),
as.Date("2017-11-01", origin= "1970-01-01")),
labels=c("April", "May", "June", "July", "August", "September", "October", "November"))+
geom_smooth(mapping= aes(x=Sdate, y=Total, color=..y..), se= F, show.legend= F)+
scale_color_gradient2(low= "blue", mid="yellow", high= "red", midpoint= median(daytotal$Total))
