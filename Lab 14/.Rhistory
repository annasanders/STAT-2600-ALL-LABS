scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=(1, 2,3,4,5), labels=c("Poor", "Fair", "Good", "Very Good", "Excellet"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=hlthnum, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c(1, 2,3,4,5), labels=c("Poor", "Fair", "Good", "Very Good", "Excellet"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=hlthnum, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(labels=cc("poor"= "1", "fair"= "2", "^good"= "3", "very good"= "4", "excellent"= "5"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=hlthnum, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(labels=c("poor"= "1", "fair"= "2", "^good"= "3", "very good"= "4", "excellent"= "5"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=hlthnum, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_continuous(labels=c("poor"= "1", "fair"= "2", "^good"= "3", "very good"= "4", "excellent"= "5"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=hlthnum, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(labels=c("poor"= "1", "fair"= "2", "^good"= "3", "very good"= "4", "excellent"= "5"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=hlthnum, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c(1,2,3,4,5), labels=c("Poor", "Fair", "Good", "Very Good", "Excellet"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=hlthnum, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("1","2","3","4","5"), labels=c("Poor", "Fair", "Good", "Very Good", "Excellet"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=hlthnum, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=genhlth, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))
scale_x_discrete(breaks=c("poor","fiar","good","ver good","excellent"), labels=c("Poor", "Fair", "Good", "Very Good", "Excellet"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=genhlth, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fiar","good","ver good","excellent"), labels=c("Poor", "Fair", "Good", "Very Good", "Excellet"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=genhlth, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"), labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
cdc3<- cdc2%>%
mutate(hlthnum= as.numeric(str_replace_all(genhlth, c("poor"= "1", "fair"= "2", "^good"= "3", "very good"= "4", "excellent"= "5"))))%>%
as.factor(genhlth)
cdc3<-as.factor(cdc3$genhlth)
cdc3<-as.factor(cdc3, genhlth)
cdc3<-as.factor(cdc3,genhlth)
cdc3<-cdc3%>%
as.factor(genhlth)
cdc3<-cdc3%>%
as.factor(cdc$genhlth)
cdc3<-as.factor(cdc$genhlth)
cdc3<- cdc3%>%
mutate(genhlthf=as.factor(cdc$genhlth))
cdc3<- cdc2%>%
mutate(hlthnum= as.numeric(str_replace_all(genhlth, c("poor"= "1", "fair"= "2", "^good"= "3", "very good"= "4", "excellent"= "5"))))
cdc4<- cdc3%>%
mutate(genhlthf=as.factor(cdc$genhlth))
View(cdc4)
print(levels(cdc4$genhlthf))
cdc4<- factor(genhlthf= levels(x)[c(5:1)])
cdc4<- factor(genhlthf= levels(c(5:1))
print(levels(cdc4$genhlthf))
cdc4<- factor(genhlthf= levels(c(5:1)))
cdc4<- factor(genhlthf, levels(c(5:1)))
genhlthf<- ordered(c("poor","fair","good","very good","excellent"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=genhlth, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=reorder(genhlthf, levels= levels(genhlthf)[5:1]), fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=reorder(genhlthf, levels= levels(genhlthf)[c(5:1)]), fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
cdc4$genhlthf%>%
fct_rev()
cdc4$genhlthf%>%
fct_relevel("poor", "fair", "good", "very good")
cdc4$genhlthf%>%
fct_relevel("poor", "fair", "good", "very good")%>%
levels()
ggplot(data=cdc3)+
geom_bar(mapping=aes(x=genhlthf, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
ggplot(data=cdc4)+
geom_bar(mapping=aes(x=genhlthf, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
cdc4$genhlthf%>%
fct_relevel("poor", "fair", "good", "very good")%>%
levels()
View(cdc4)
cdc4$genhlthf%>%
fct_relevel("poor", "fair", "good", "very good")%>%
levels()%>%
fct_rev()
ggplot(data=cdc4)+
geom_bar(mapping=aes(x=genhlthf, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
cdc4$genhlthf%>%
fct_relevel("poor", "fair", "good", "very good")%>%
levels()
ggplot(data=cdc4)+
geom_bar(mapping=aes(x=genhlthf, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))
ggplot(data=cdc4)+
geom_bar(mapping=aes(x=genhlthf, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
# Statistics
## Overall
mean(cdc3$hlthnum)
sd(cdc3$hlthnum)
mean(cdcno$hlthnum)
sd(cdcno$hlthnum)
mean(cdcyes$hlthnum)
sd(cdcyes$hlthnum)
ggplot(data=cdc,aes(x=age,color=gender))+geom_area(stat="bin")+facet_wrap(~exerany)+
labs(x='Age',y='Count of People',title='Exercise and Age (0 = No exercise, 1 = Exercise)')
ggplot(data=cdc4)+
geom_bar(mapping=aes(x=genhlthf, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
ggplot(data=cdc4)+
geom_bar(mapping=aes(x=genhlthf, fill=as.factor(hlthplan)))+
labs(x="General Health", y="Count", title="General Health and Health Plan")+
scale_fill_discrete(name="Health Plan", breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_x_discrete(breaks=c("poor","fair","good","very good","excellent"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
# New Plots
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, color=hlthnum))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, color=hlthnum))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, color=hlthnum))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))+
scale_y_discrete(breaks=c("1","2","3","4","5"),
labels=c("Poor", "Fair", "Good", "Very Good", "Excellent"))
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, color=hlthnum))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, fill=hlthnum))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, fill=hlthnum))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))+
stat_summary(fun.data="mean_sdl", mult=1,
geom="crossbar", width=0.2 )
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, color=as.factor(hltplan)))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, color=as.factor(hlthplan)))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, color=as.factor(hlthplan)))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))+
legend(title=FALSE)
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, color=as.factor(hlthplan)))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))+
theme(legend.title=element_blank())
ggplot(data=cdc3, aes(x=as.factor(hlthplan), y=hlthnum, color=as.factor(hlthplan)))+
geom_violin()+
labs(x="Health Plan", y="General Health", title="Health Plan and General Helath")+
scale_x_discrete(breaks=c("1", "0"), labels=c("Yes", "No"))+
theme(legend.position="none")
library(gapminder)
gapminder<- gapminder
country_model<- function(df){lm(lifeExp ~year, data=df)}
country_model<- function(gapminder){lm(lifeExp ~year, data=gapminder)}
country_model<- function(gapminder){lm(lifeExp ~year, data=gapminder)}
gapminder%>% group_by(country, continent) %>% nest()
country_model<- function(gapminder){lm(lifeExp ~year, data=gapminder)}
View(country_model)
country_model<- function(df){lm(lifeExp ~year, data=df)}
country_model(gapminder)
country_model(gapminder$country)
country_model(gapminder)
gapminder2<- gapminder%>%
mutate(model= map(data, country_model))
country_model<- function(df){lm(lifeExp ~year, data=df)}
gapminder2<- gapminder%>%
mutate(model= map(data, country_model))
country_model<- function(df){lm(lifeExp ~year, data=df)}
gapminder2<- gapminder%>%
mutate(model= map(data, country_model))
gapminder2<- gapminder%>%
mutate(model= as.vector(map(data, country_model)))
gapminder2<- gapminder%>%
mutate(model= map(gapminder$data, country_model))
View(gapminder)
gapminder2<- gapminder%>%
group_by(country, continent) %>% nest()
country_model<- function(df){lm(lifeExp ~year, data=df)}
gapminder3<- gapminder2%>%
mutate(model= map(gapminder2$data, country_model))
View(gapminder3)
View(gapminder3)
View(gapminder3)
extract_slope[1][[2]]
gapminder3[1][[2]]
gapminder3([1][[2]])
gapminder3[[1][[2]]]
gapminder3[[1[[2]]]}
gapminder3[[1[[2]]]]
gapminder3[1]
gapminder3[2]
gapminder3[2]
gapminder3[3]
gapminder3[3][2]
gapminder3[3][[2]]
gapminder3[3][[3]]
gapminder3[3[[2]]]
gapminder3[3[[4]]]
gapminder3[3][[3]]
gapminder3[3][[2]]
gapminder3[3][[1]]
gapminder3[3][[a]]
gapminder3[3][[5]]
gapminder3[3][[4]]
gapminder3[3][[1]]
gapminder3[3][[5]]
gapminder3[3][[2]]
gapminder3[3][[year]]
gapminder3[3][[1]]
gapminder3[3][[3]]
gapminder3[3][[4]]
gapminder3[4][[1]]
gapminder[3][[1]][[2]]
gapminder[3][[1]][[1]]
gapminder[3][[1]][[[2]]]
gapminder[3][[1]][[[2]]]
gapminder[3][[1]][[2]]
gapminder4<- gapminder3%>%
mutate(coef= gapminder3[4][[1]])
View(gapminder4)
gapminder[3][[1]][[2]]
gapminder[3][[1]][[1]]
gapminder[3][[1]][[[2]]]
gapminder[3][[1]][[[1]]]
gapminder[3][[1]][[1]]
gapminder[3][[1]]
gapminder3[3][[1]]
gapminder3[4][[1]]
gapminder3[4][[1]][[1]]
gapminder3[4][[1]]
gapminder3[4][[2]]
gapminder3[4][[1]]
gapminder3[4][[1,2]]
gapminder3[4][[1]][[2]]
gapminder3[4][[1]][[3]]
gapminder3[4][[1]][[1,2]]
gapminder3[4][[1]][[4]]
gapminder3[4][[1]][[[1,2]]]
gapminder3[4][[1]][[[1,2]]]]
gapminder3[4][[1]][[[[1,2]]]]
gapminder3[4][[1]][2]
gapminder3[4][[1]][2][2]
gapminder3[4][[1]][2][1]
gapminder3[4][[1]][2,1]
gapminder3[4][[1]][[2,1]]
ggplot(data=cdc,aes(x=age,fill=gender))+geom_area(stat="bin")+facet_wrap(~exerany)+
labs(x='Age',y='Count of People',title='Exercise and Age (0 = No exercise, 1 = Exercise)')
ggplot(data=cdc,aes(x=age,fill=gender))+geom_area(stat="bin")+facet_wrap(~exerany)+
labs(x='Age',y='Count of People',title='Exercise and Age (0 = No exercise, 1 = Exercise)')
+geom_hist(stat="bin")
+geom_histogram(stat="bin")
+labs(x='Age',y='Count of People',title='Exercise and Age (0 = No exercise, 1 = Exercise)')
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
labs(x='Age',y='Count of People',title='Exercise and Age (0 = No exercise, 1 = Exercise)')
exersize<- list(
"1"="Yes"
"2"="No"
exersize<- list(
"1"="Yes",
"2"="No"
)
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
labs(x='Age',y='Count of People',title='Exercise and Age (0 = No exercise, 1 = Exercise)')
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
labs(x='Age',y='Count of People',title='Exercise and Age (0 = No Exercise, 1 = Exercise)')
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
scale_fill_discrete(breaks=c("Male","Female"))
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))
labs(x="Age",y="Count of People",title='"Exercise and Age (0 = No Exercise, 1 = Exercise)")
labs(x="Age",y="Count of People",title='"Exercise and Age (0 = No Exercise, 1 = Exercise)")
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title='"Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title="Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title="Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title="Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title="Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age", y="Count of People", title="Exercise and Age (0= No Exercise, 1= Exercise)")
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age", y="Count of People", title='Exercise and Age (0= No Exercise, 1= Exercise)')
ggplot(data=cdc,aes(x=age,fill=gender))+
geom_histogram(stat="bin")+
facet_wrap(~exerany)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age", y="Count of People", title="Exercise and Age (0= No Exercise, 1= Exercise)")
ggplot(data=cdc,aes(x=age, fill=exerany))+
geom_histogram(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title="Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age, fill=exerany))+
geom_histogram(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title="Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_histogram(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title="Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_fill(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title="Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Gender", breaks=c("m", "f"), labels=c("Male","Female"))+
labs(x="Age",y="Count of People",title="Exercise and Age (0 = No Exercise, 1 = Exercise)")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Exercise", breaks=c("0", "1"), labels=c("No","Yes"))+
labs(x="Age",y="Count of People",title="Exercise and Age)")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Exercise", breaks=c("0", "1"), labels=c("No","Yes"))+
labs(x="Age",y="Count of People",title="Exercise and Age)")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Exercise", breaks=c("0", "1"), labels=c("No","Yes"))+
labs(x="Age",y="Count of People",title="Exercise and Age)")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Exercise", breaks=c("0", "1"), labels=c("No","Yes"))+
labs(x="Age",y="Count of People",title="Exercise and Age)")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Exercise", breaks=c("0", "1"), labels=c("No","Yes"))+
labs(x="Age",y="Count of People",title="Exercise and Age")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Exercise", breaks=c("0", "1"), labels=c("No","Yes"))+
labs(x="Age",y="Count of People",title="Exercise and Age")
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Exercise", breaks=c("0", "1"), labels=c("No","Yes"))+
labs(x="Age",y="Count of People",title="Exercise and Age")
# Permutation Test
health <- cdc4%>%
select(hlthnum)
plan <- cdc4%>%
select(hlthplan)
real_cor <- cor(health, plan)
# Permutation Test
health <- cdc4%>%
select(hlthnum)
plan <- cdc4%>%
select(hlthplan)
real_cor <- cor(health, plan)
perm_cor <- function(perms = 1000, x, y)
{
corr_mat <- matrix(0,length(perms),1)
mylist <- rep(list(0,1000))
for (i in c(1:perms))
{
mylist[[i]] <- sample(y, length(y), replace = FALSE)
corr_mat[[i]] = real_cor + cor(x,mylist[[i]])
}
return(corr_mat)
}
healthplan <- perm_cor(x=health, y=plan)
map_dbl(healthplan, median)
healthplan2 <- as.tibble(healthplan)
props <- as.tibble(quantile(healthplan2))
props <- as.tibble(quantile(healthplan2))
healthplan2 <- as.tibble(healthplan)
props <- as.tibble(quantile(healthplan))
standard_dev <- sd(healthplan)
ggplot(healthplan2, aes(x=value))+
geom_histogram()+
labs(x= "Correlation", y = "Count", title = "Correlation Between General Health and Health Plan")+
geom_vline(xintercept = real_cor, col = "Blue")
healthplan <- perm_cor(x=health, y=plan)
healthplan2 <- as.tibble(healthplan)
props <- as.tibble(quantile(healthplan))
ggplot(healthplan2, aes(x=value))+
geom_histogram()+
labs(x= "Correlation", y = "Count", title = "Correlation Between General Health and Health Plan")+
geom_vline(xintercept = real_cor, col = "Blue")
ggplot(healthplan2, aes(x=value))+
geom_histogram(bins=20)+
labs(x= "Correlation", y = "Count", title = "Correlation Between General Health and Health Plan")+
geom_vline(xintercept = real_cor, col = "Blue")
ggplot(healthplan2, aes(x=value))+
geom_histogram(bins=200)+
labs(x= "Correlation", y = "Count", title = "Correlation Between General Health and Health Plan")+
geom_vline(xintercept = real_cor, col = "Blue")
ggplot(healthplan2, aes(x=value))+
geom_histogram(bins=1)+
labs(x= "Correlation", y = "Count", title = "Correlation Between General Health and Health Plan")+
geom_vline(xintercept = real_cor, col = "Blue")
View(healthplan2)
ggplot(data=cdc,aes(x=age, fill=as.factor(exerany)))+
geom_area(stat="bin")+
facet_wrap(~gender)+
scale_fill_discrete(name= "Exercise", breaks=c("0", "1"), labels=c("No","Yes"))+
labs(x="Age",y="Count of People",title="Exercise and Age")
